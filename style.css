/* ================================================================
   FICHIER : style.css — Budget Pro
   ORGANISATION :
     1. Variables de design (couleurs, tailles)
     2. Reset & Base
     3. Page de connexion
     4. Navigation
     5. Conteneur principal
     6. Cartes (cards)
     7. Formulaires
     8. Graphiques
     9. Filtres
    10. Tableau des dépenses
    11. Cartes mobiles des dépenses
    12. États (chargement, vide, erreur)
    13. Bouton flottant (FAB)
    14. Utilitaires
    15. RESPONSIVE MOBILE (media queries)
   ================================================================ */


/* ── 1. VARIABLES DE DESIGN ──────────────────────────────────── */
:root {
    /* Couleurs principales */
    --primary:      #4a90e2;   /* Bleu principal */
    --primary-dark: #357abd;   /* Bleu foncé (hover) */
    --success:      #2ecc71;   /* Vert (succès) */
    --danger:       #e74c3c;   /* Rouge (erreur/suppression) */
    --warning:      #f39c12;   /* Orange (avertissement) */
    --dark:         #2c3e50;   /* Gris très foncé */
    --medium:       #7f8c8d;   /* Gris moyen */
    --light:        #ecf0f1;   /* Gris clair */
    --white:        #ffffff;
    --bg:           #f0f4f8;   /* Fond de page */

    /* Couleurs par catégorie (utilisées aussi dans Chart.js) */
    --cat-food:      #e74c3c;   /* Alimentation = rouge */
    --cat-transport: #3498db;   /* Transport = bleu */
    --cat-leisure:   #9b59b6;   /* Loisirs = violet */
    --cat-health:    #2ecc71;   /* Santé = vert */

    /* Espacements */
    --spacing-xs:  4px;
    --spacing-sm:  8px;
    --spacing-md:  16px;
    --spacing-lg:  24px;
    --spacing-xl:  32px;

    /* Arrondis */
    --radius-sm:  6px;
    --radius-md:  12px;
    --radius-lg:  20px;
    --radius-xl:  30px;

    /* Ombres */
    --shadow-sm:  0 2px 8px rgba(0,0,0,0.08);
    --shadow-md:  0 4px 16px rgba(0,0,0,0.12);
    --shadow-lg:  0 8px 32px rgba(0,0,0,0.16);

    /* Transitions */
    --transition: 0.25s ease;

    /* Taille de police de base */
    --font-base: 16px;
}


/* ── 2. RESET & BASE ─────────────────────────────────────────── */
*, *::before, *::after {
    box-sizing: border-box; /* Inclure padding et border dans la largeur */
    margin: 0;
    padding: 0;
}

html {
    font-size: var(--font-base);
    -webkit-text-size-adjust: 100%; /* Évite le zoom auto sur iOS */
    scroll-behavior: smooth;
}

body {
    font-family: 'Segoe UI', Roboto, -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--dark);
    min-height: 100vh;
    line-height: 1.5;
    /* Optimisation tactile mobile */
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
}

/* Accessibilité : outline visible au clavier */
:focus-visible {
    outline: 3px solid var(--primary);
    outline-offset: 2px;
}


/* ── 3. PAGE DE CONNEXION ────────────────────────────────────── */
.login-body {
    background: linear-gradient(135deg, #4a90e2 0%, #2c3e50 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: var(--spacing-md);
}

.login-wrapper {
    width: 100%;
    max-width: 420px;
}

.login-header {
    text-align: center;
    color: var(--white);
    margin-bottom: var(--spacing-lg);
}

.login-logo {
    font-size: 4rem;
    margin-bottom: var(--spacing-sm);
    animation: bounce 2s infinite; /* Animation douce */
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50%       { transform: translateY(-8px); }
}

.login-header h1 {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 4px;
}

.login-header p {
    opacity: 0.85;
    font-size: 0.95rem;
}

.login-card {
    background: var(--white);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    box-shadow: var(--shadow-lg);
}

/* Onglets Connexion / Inscription */
.tab-switcher {
    display: flex;
    margin-bottom: var(--spacing-lg);
    background: var(--light);
    border-radius: var(--radius-xl);
    padding: 4px;
}

.tab-btn {
    flex: 1;
    padding: 10px;
    border: none;
    background: transparent;
    border-radius: var(--radius-xl);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    color: var(--medium);
}

.tab-btn.active {
    background: var(--white);
    color: var(--primary);
    box-shadow: var(--shadow-sm);
}

/* Formulaires d'authentification */
.auth-form {
    display: none; /* Caché par défaut */
}

.auth-form.active {
    display: block;
}

.password-wrapper {
    position: relative;
    display: flex;
}

.password-wrapper input {
    flex: 1;
    padding-right: 48px; /* Espace pour le bouton œil */
}

.eye-btn {
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.2rem;
    padding: 4px;
    opacity: 0.6;
}


/* ── 4. NAVIGATION ───────────────────────────────────────────── */
.topbar {
    position: sticky;       /* La nav reste collée en haut en scrollant */
    top: 0;
    z-index: 100;
    background: var(--dark);
    color: var(--white);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px var(--spacing-md);
    box-shadow: var(--shadow-md);
}

.topbar-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.logo-icon { font-size: 1.5rem; }
.logo-text  { font-size: 1.1rem; font-weight: 700; }

.topbar-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.nav-username {
    font-size: 0.85rem;
    opacity: 0.8;
    display: none; /* Caché sur petits écrans */
}

.btn-logout {
    background: rgba(255,255,255,0.15);
    color: var(--white);
    border: 1px solid rgba(255,255,255,0.3);
    padding: 6px 14px;
    border-radius: var(--radius-xl);
    cursor: pointer;
    font-size: 0.85rem;
    transition: var(--transition);
}

.btn-logout:hover {
    background: rgba(255,255,255,0.25);
}


/* ── 5. CONTENEUR PRINCIPAL ──────────────────────────────────── */
.main-container {
    max-width: 900px;
    margin: 0 auto;
    padding: var(--spacing-md);
    padding-bottom: 80px; /* Espace pour le FAB en bas */
}


/* ── 6. CARTES ───────────────────────────────────────────────── */
.card {
    background: var(--white);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    box-shadow: var(--shadow-sm);
    border: 1px solid rgba(0,0,0,0.05);
}

.section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-md);
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}

.section-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--dark);
    margin-bottom: var(--spacing-md);
}

.section-header .section-title {
    margin-bottom: 0;
}


/* ── 7. FORMULAIRES ──────────────────────────────────────────── */
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 2 colonnes égales */
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.field-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--dark);
}

input, select {
    padding: 12px 14px;
    border: 2px solid #e0e0e0;
    border-radius: var(--radius-sm);
    font-size: 1rem;
    color: var(--dark);
    background: var(--white);
    transition: border-color var(--transition);
    width: 100%;
    /* Évite le zoom automatique sur iOS lors du focus (bug courant) */
    font-size: 16px;
}

input:focus, select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(74,144,226,0.2);
}

input::placeholder {
    color: #b0b0b0;
}

/* Boutons principaux */
.btn-primary {
    background: var(--primary);
    color: var(--white);
    border: none;
    padding: 14px 24px;
    border-radius: var(--radius-sm);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background var(--transition), transform 0.1s;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
}

.btn-primary:hover   { background: var(--primary-dark); }
.btn-primary:active  { transform: scale(0.98); }

.btn-full {
    width: 100%;
    margin-top: var(--spacing-sm);
}

/* État de chargement des boutons */
.btn-loading { display: none; }
.btn-text    { display: inline; }


/* ── 8. GRAPHIQUES ───────────────────────────────────────────── */
.chart-controls select {
    width: auto;
    font-size: 0.9rem;
    padding: 8px 12px;
}

/* Canvas Chart.js : le graphique s'adapte à son conteneur */
.chart-wrapper {
    position: relative;
    height: 280px; /* Hauteur fixe pour cohérence */
    width: 100%;
}

#main-chart {
    max-height: 280px;
}


/* ── 9. FILTRES ET TOTAL ─────────────────────────────────────── */
.filter-bar {
    background: var(--dark);
    color: var(--white);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
    min-width: 140px;
}

.filter-group label {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.7);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.filter-group select {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    color: var(--white);
    border-radius: var(--radius-sm);
    padding: 8px 12px;
}

.filter-group select option {
    background: var(--dark); /* Options visibles sur fond sombre */
}

.total-box {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 2px;
    margin-left: auto;
}

.total-label    { font-size: 0.75rem; opacity: 0.7; text-transform: uppercase; }
#total-display  { font-size: 1.6rem; font-weight: 700; color: var(--success); }
.total-currency { font-size: 0.8rem; opacity: 0.7; }


/* ── 10. TABLEAU DES DÉPENSES (grand écran) ──────────────────── */
.table-wrapper {
    background: var(--white);
    border-radius: var(--radius-md);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
}

.expense-table {
    width: 100%;
    border-collapse: collapse;
}

.expense-table th {
    background: #f8f9fa;
    padding: 12px 16px;
    text-align: left;
    font-size: 0.85rem;
    color: var(--medium);
    border-bottom: 2px solid var(--primary);
    white-space: nowrap;
}

.expense-table td {
    padding: 14px 16px;
    border-bottom: 1px solid #f0f0f0;
    font-size: 0.95rem;
}

.expense-table tr:last-child td { border-bottom: none; }

.expense-table tr:hover td {
    background: #f8fbff;
}

/* Badge de catégorie dans le tableau */
.badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: var(--radius-xl);
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--white);
}

.badge-Alimentation { background: var(--cat-food); }
.badge-Transport    { background: var(--cat-transport); }
.badge-Loisirs      { background: var(--cat-leisure); }
.badge-Santé        { background: var(--cat-health); }

.montant-cell {
    font-weight: 700;
    color: var(--danger);
    white-space: nowrap;
}

.date-cell {
    font-size: 0.85rem;
    color: var(--medium);
}

.delete-btn {
    background: none;
    border: 1px solid var(--danger);
    color: var(--danger);
    padding: 5px 10px;
    border-radius: var(--radius-sm);
    cursor: pointer;
    font-size: 0.85rem;
    transition: var(--transition);
}

.delete-btn:hover {
    background: var(--danger);
    color: var(--white);
}


/* ── 11. CARTES MOBILES DES DÉPENSES ─────────────────────────── */
/* Sur mobile, chaque dépense s'affiche comme une carte plutôt qu'une ligne de tableau */
.expense-cards {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm);
}

.expense-card {
    background: var(--white);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    box-shadow: var(--shadow-sm);
    border-left: 4px solid var(--primary);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
}

.expense-card-Alimentation { border-left-color: var(--cat-food); }
.expense-card-Transport    { border-left-color: var(--cat-transport); }
.expense-card-Loisirs      { border-left-color: var(--cat-leisure); }
.expense-card-Santé        { border-left-color: var(--cat-health); }

.card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.card-name     { font-weight: 700; font-size: 1rem; }
.card-amount   { font-weight: 800; font-size: 1.1rem; color: var(--danger); }
.card-meta     { font-size: 0.8rem; color: var(--medium); display: flex; gap: var(--spacing-sm); flex-wrap: wrap; }
.card-footer   { display: flex; align-items: center; justify-content: space-between; margin-top: var(--spacing-xs); }


/* ── 12. ÉTATS (chargement, vide, erreur) ────────────────────── */
.loading-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: var(--spacing-xl);
    gap: var(--spacing-md);
    color: var(--medium);
}

/* Spinner animé */
.spinner {
    width: 40px;
    height: 40px;
    border: 4px solid var(--light);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: var(--spacing-xl);
    gap: var(--spacing-sm);
    color: var(--medium);
    text-align: center;
}

.empty-icon { font-size: 3rem; }
.empty-sub  { font-size: 0.85rem; opacity: 0.7; }

/* Messages d'erreur et succès */
.error-msg, .success-msg {
    padding: 10px 14px;
    border-radius: var(--radius-sm);
    font-size: 0.9rem;
    margin-top: var(--spacing-sm);
}

.error-msg   { background: #fde8e8; color: #c0392b; border: 1px solid #f5c6cb; }
.success-msg { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }

/* Bannière hors ligne */
.offline-banner {
    background: var(--warning);
    color: var(--white);
    text-align: center;
    padding: 8px;
    font-size: 0.9rem;
    font-weight: 600;
    z-index: 200;
}


/* ── 13. BOUTON FLOTTANT FAB ─────────────────────────────────── */
/* Visible uniquement sur mobile pour un accès rapide */
.fab {
    position: fixed;
    bottom: var(--spacing-lg);
    right: var(--spacing-lg);
    width: 56px;
    height: 56px;
    background: var(--primary);
    color: var(--white);
    border: none;
    border-radius: 50%;
    font-size: 2rem;
    line-height: 1;
    cursor: pointer;
    box-shadow: 0 4px 16px rgba(74,144,226,0.5);
    transition: var(--transition);
    display: none; /* Caché par défaut, affiché sur mobile */
    align-items: center;
    justify-content: center;
    z-index: 50;
}

.fab:hover  { background: var(--primary-dark); transform: scale(1.1); }
.fab:active { transform: scale(0.95); }


/* ── 14. UTILITAIRES ─────────────────────────────────────────── */
.hidden { display: none !important; }


/* ── 15. RESPONSIVE MOBILE ───────────────────────────────────── */
/*
   On développe "mobile first" :
   - Les styles de base = téléphone
   - Les @media queries ajoutent du style pour les grands écrans
*/

/* Tablettes et grand téléphones (≥ 600px) */
@media (min-width: 600px) {
    .nav-username { display: block; }
    .main-container { padding: var(--spacing-lg); }
    .card { padding: var(--spacing-lg); }
    .chart-wrapper { height: 320px; }
    #main-chart { max-height: 320px; }
}

/* Petits téléphones (< 480px) */
@media (max-width: 480px) {

    /* Formulaire : 1 colonne sur mobile */
    .form-row {
        grid-template-columns: 1fr; /* 1 seule colonne */
    }

    /* Cacher le tableau, montrer les cartes */
    .expense-table { display: none !important; }
    .expense-cards.hidden { display: flex !important; }

    /* Afficher le bouton flottant */
    .fab { display: flex; }

    /* Total plus petit */
    #total-display { font-size: 1.3rem; }

    /* Login */
    .login-card { padding: var(--spacing-md); }

    .filter-bar {
        flex-direction: column;
        align-items: stretch;
    }

    .total-box { align-items: flex-start; }
}

/* Téléphones moyens (480px - 767px) */
@media (min-width: 481px) and (max-width: 767px) {
    .expense-table { display: none !important; }
    .expense-cards.hidden { display: flex !important; }
    .fab { display: flex; }
}

/* Grand écran (≥ 768px) : afficher le tableau, cacher les cartes */
@media (min-width: 768px) {
    .expense-table { display: table !important; }
    .expense-cards { display: none !important; }
    .fab { display: none !important; }
}
